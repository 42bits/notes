### 接口防篡改和重放攻击

- 防止sql注入
- 防止xss攻击
- 防止请求参数被串改
- 防止重放攻击

主要手段

- 请求合法化校验
- 请求数据进行校验

**防止重放攻击必须要保证请求只能有效一次，可以在请求中带该请求的唯一标示，并且进行签名防止串改**

请求参数防篡改

- 客户端使用约定好的秘钥对参数进行加密，得到签名值，signature，将该值也放到请求参数中
- 服务端对接收到的参数通过同样的方法进行加密，得到签名值 autograph
- 对比signature 和autograph

*签名的秘钥可以采用对称加密后非对称加密*

防止重放攻击

> 基于timestamp 和nonce

1:每次请求都带上timestamp参数，和其他参数一起加密，服务端判断请求时间是否已经失效，比如超过60s算失败，
2:通过nonce 来解决60s内问题，每次请求该参数值都不一样，一般使用时间戳，也可以加上客户端ip或mac地址，做hash值后作为该参数的值
3:将每次请求中的该参数都保存下来，一般保存60s就行，一般存储在缓存中
4:每次请求是都判断该值是否在集合中，如果存在则是非法请求

服务端一般判断流程
> http://baidu.com/jshawcx/1/info?url=jshawcx/1/info&token=xxx&timestamp=150045613344&noncestr=12222-ccc-xxx-434esd&signature=3646589djfhyr9383hd

- 判断参数是否为空
- 判断token值
- 判断请求的url参数是否正确
- 判断时间是否大于60s
- 判断 nonce是否在集合中
- 对请求头参数进行签名判断是否相等
- 将本次的nonce 存储到缓存中，60s过期

